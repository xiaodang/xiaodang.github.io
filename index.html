<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="cache-control" content="no-cache">
  <meta http-equiv="expires" content="0">
  
  <title>xiaodang&#39;s blog</title>
  <meta name="author" content="xiaodang">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="xiaodang&#39;s blog"/>

  
    <meta property="og:image" content=""/>
  

  
    <link rel="alternative" href="/atom.xml" title="xiaodang&#39;s blog" type="application/atom+xml">
  
  
    <link href="/favicon.png" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-1XXD3NYJLC"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-1XXD3NYJLC');
</script>






<meta name="generator" content="Hexo 5.2.0"></head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation"
	style="background-color:transparent;">
	<div class="container">
		<!-- navbar-header -->
		<button type="button" class=" navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
			<span class="navbar-text">
				MENU
			</span>
		</button>
		<a class="navbar-brand" href="/">xiaodang&#39;s blog</a>
		<div class="collapse navbar-collapse nav-menu" style="height: auto;position: absolute;top: 0px;right: 100px;">
			<ul class="nav navbar-nav">
				
				<li>
					<a href="/archives" title="All the articles.">
						<i class=""></i>Archives
					</a>
				</li>
				
				<li>
					<a href="/categories" title="All the categories.">
						<i class=""></i>Categories
					</a>
				</li>
				
				<li>
					<a href="/tags" title="All the tags.">
						<i class=""></i>Tags
					</a>
				</li>
				
				<li>
					<a href="/about" title="About me.">
						<i class=""></i>About
					</a>
				</li>
				
			</ul>
		</div>
	</div> <!-- container -->
</nav>
<div class="clearfix"></div>
  <div class="container">
  	<div class="content">
    	 <div class="page-header logo">
  <h1>xiaodang&#39;s blog<span class="blink-fast">|</span></h1>
</div>

<div class="row page">

	
	<div class="col-md-9">
	

		<div class="slogan">


		<i class="fa fa-heart blink-slow"></i>

		DiDa DiDa DiDa

</div>    

		<div id="top_search"></div>
		<div class="mypage">
		
		<!-- title and entry -->
		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2021/03/05/什么是霍夫曼编码-Huffman-Coding/" >什么是霍夫曼编码(Huffman Coding)</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2021-03-05  </div>
		</div>
	</div>
	


			<!--
<div class="entry">
  <div class="row">
	
	
		<p>本文翻译自:<a target="_blank" rel="noopener" href="https://www.baseclass.io/huffman-coding/">What is Huffman Coding?</a></p>
<h2 id="什么是哈夫曼编码"><a href="#什么是哈夫曼编码" class="headerlink" title="什么是哈夫曼编码"></a>什么是哈夫曼编码</h2><p>霍夫曼编码算法是许多压缩算法的基石，如DEFLATE，它被用于PNG格式的图像和GZIP。</p>
<h2 id="为什么需要关注它"><a href="#为什么需要关注它" class="headerlink" title="为什么需要关注它"></a>为什么需要关注它</h2><p>你是否也曾想了解:</p>
<ul>
<li>如何在不丢失数据的情况下，对数据进行压缩？</li>
<li>为什么某些数据的压缩效果要比其他数据的效果好？</li>
<li>GZIP如何工作？</li>
</ul>
<h2 id="5分钟内了解它"><a href="#5分钟内了解它" class="headerlink" title="5分钟内了解它"></a>5分钟内了解它</h2><p>假设我们需要压缩一个字符串(哈夫曼编码可以用于任何数据，但是字符串更好理解)。</p>
<p>在被压缩的文本中，一些字符出现的频率总是比其他字符的高。霍夫曼编码利用这一事实，使得最常用的字符比不常用的字符占用更少的空间。</p>
<h3 id="编码字符串"><a href="#编码字符串" class="headerlink" title="编码字符串"></a>编码字符串</h3>
	

	</div>
  <a type="button" href="/2021/03/05/什么是霍夫曼编码-Huffman-Coding/#more" class="btn btn-default more">Read More</a>
</div>

-->
<div class="entry">
  <div class="row">
	
	
		<p>本文翻译自:<a target="_blank" rel="noopener" href="https://www.baseclass.io/huffman-coding/">What is Huffman Coding?</a></p>
<h2 id="什么是哈夫曼编码"><a href="#什么是哈夫曼编码" class="headerlink" title="什么是哈夫曼编码"></a>什么是哈夫曼编码</h2><p>霍夫曼编码算法是许多压缩算法的基石，如DEFLATE，它被用于PNG格式的图像和GZIP。</p>
<h2 id="为什么需要关注它"><a href="#为什么需要关注它" class="headerlink" title="为什么需要关注它"></a>为什么需要关注它</h2><p>你是否也曾想了解:</p>
<ul>
<li>如何在不丢失数据的情况下，对数据进行压缩？</li>
<li>为什么某些数据的压缩效果要比其他数据的效果好？</li>
<li>GZIP如何工作？</li>
</ul>
<h2 id="5分钟内了解它"><a href="#5分钟内了解它" class="headerlink" title="5分钟内了解它"></a>5分钟内了解它</h2><p>假设我们需要压缩一个字符串(哈夫曼编码可以用于任何数据，但是字符串更好理解)。</p>
<p>在被压缩的文本中，一些字符出现的频率总是比其他字符的高。霍夫曼编码利用这一事实，使得最常用的字符比不常用的字符占用更少的空间。</p>
<h3 id="编码字符串"><a href="#编码字符串" class="headerlink" title="编码字符串"></a>编码字符串</h3>
	
	</div>
  <a type="button" href="/2021/03/05/什么是霍夫曼编码-Huffman-Coding/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2021/02/28/SSL-routines-tls-process-ske-dhe-dh-key-too-small/" >SSL routines:tls_process_ske_dhe:dh key too small</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2021-02-28  </div>
		</div>
	</div>
	


			<!--
<div class="entry">
  <div class="row">
	
	
		<p>今天遇到一个问题,有一个第三方HTTP接口，在本地通过Node.JS可以正常访问，但是CentOS服务器无法访问，错误日志提示:<code>Error: socket hang up</code></p>
<p>这个错误很明显是socket网络层的错误，还没有到第三方到应用层。为了严重猜想，随便换一个HTTP接口，然后用curl测试，curl返回：<code>curl: (35) error:141A318A:SSL routines:tls_process_ske_dhe:dh key too small</code>。</p>
<p>通过错误可以看出来是HTTPS中的SSL/TLS层的问题，通过GOOGLE，发现是目标服务器在握手中返回的加密算法的key长度不够。</p>
<p>通过以下命令在我的机器上执行，可以查看目标服务器返回的key长度</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">openssl s_client -connect xxx:443 -cipher <span class="string">&quot;EDH&quot;</span> | grep <span class="string">&quot;Server Temp Key&quot;</span></span><br><span class="line">openssl s_client -connect www.example.com:443 -cipher <span class="string">&quot;DHE&quot;</span> | grep <span class="string">&quot;Server Temp Key&quot;</span></span><br></pre></td></tr></table></figure>
<p>以上命令返回中包含<code>Server Temp Key: DH, 1024 bits</code>，key的长度是1024。</p>
<p>接着查看系统的加密策略，执行以下命令返回<code>DEFAULT</code>，继续搜索文档<code>The default system-wide cryptographic policy level offers secure settings for current threat models. It allows the TLS 1.2 and 1.3 protocols, as well as the IKEv2 and SSH2 protocols. The RSA keys and Diffie-Hellman parameters are accepted if they are at least 2048 bits long.</code>发现<code>DEFAULT</code>策略要求key的长度最少为2048</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">update-crypto-policies --show</span><br><span class="line">&gt;DEFAULT</span><br></pre></td></tr></table></figure>

<p>修改系统的加密策略:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update-crypto-policies --set LEGACY</span><br></pre></td></tr></table></figure>
	

	</div>
  <a type="button" href="/2021/02/28/SSL-routines-tls-process-ske-dhe-dh-key-too-small/#more" class="btn btn-default more">Read More</a>
</div>

-->
<div class="entry">
  <div class="row">
	
	
		<p>今天遇到一个问题,有一个第三方HTTP接口，在本地通过Node.JS可以正常访问，但是CentOS服务器无法访问，错误日志提示:<code>Error: socket hang up</code></p>
<p>这个错误很明显是socket网络层的错误，还没有到第三方到应用层。为了严重猜想，随便换一个HTTP接口，然后用curl测试，curl返回：<code>curl: (35) error:141A318A:SSL routines:tls_process_ske_dhe:dh key too small</code>。</p>
<p>通过错误可以看出来是HTTPS中的SSL/TLS层的问题，通过GOOGLE，发现是目标服务器在握手中返回的加密算法的key长度不够。</p>
<p>通过以下命令在我的机器上执行，可以查看目标服务器返回的key长度</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">openssl s_client -connect xxx:443 -cipher <span class="string">&quot;EDH&quot;</span> | grep <span class="string">&quot;Server Temp Key&quot;</span></span><br><span class="line">openssl s_client -connect www.example.com:443 -cipher <span class="string">&quot;DHE&quot;</span> | grep <span class="string">&quot;Server Temp Key&quot;</span></span><br></pre></td></tr></table></figure>
<p>以上命令返回中包含<code>Server Temp Key: DH, 1024 bits</code>，key的长度是1024。</p>
<p>接着查看系统的加密策略，执行以下命令返回<code>DEFAULT</code>，继续搜索文档<code>The default system-wide cryptographic policy level offers secure settings for current threat models. It allows the TLS 1.2 and 1.3 protocols, as well as the IKEv2 and SSH2 protocols. The RSA keys and Diffie-Hellman parameters are accepted if they are at least 2048 bits long.</code>发现<code>DEFAULT</code>策略要求key的长度最少为2048</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">update-crypto-policies --show</span><br><span class="line">&gt;DEFAULT</span><br></pre></td></tr></table></figure>

<p>修改系统的加密策略:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update-crypto-policies --set LEGACY</span><br></pre></td></tr></table></figure>
	
	</div>
  <a type="button" href="/2021/02/28/SSL-routines-tls-process-ske-dhe-dh-key-too-small/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2021/02/09/GNU-SCREEN配置以及动态设置标题/" >GNU SCREEN配置以及动态设置标题</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2021-02-09  </div>
		</div>
	</div>
	


			<!--
<div class="entry">
  <div class="row">
	
	
		<p>最近开始使用GNU的screen来管理terminal的窗口，但是当开窗口多的时候，会面临不知道每个窗口是做什么的，默认的窗口标题也非常不友好，官网文档也没太多描述，最后好不容易找到了设置方法，记录一下配置。</p>
<p>.zshrc文件里添加如下配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># dynamic titles for screen</span><br><span class="line">preexec () &#123;</span><br><span class="line">  echo -ne &quot;\ek$&#123;(s: :)1&#125;\e\\&quot;</span><br></pre></td></tr></table></figure>

<p>.screenrc文件里添加如下配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">startup_message off</span><br><span class="line"></span><br><span class="line"># GNU Screen - main configuration file</span><br><span class="line"># All other .screenrc files will source this file to inherit settings.</span><br><span class="line"># Author: Christian Wills - cwills.sys@gmail.com</span><br><span class="line"></span><br><span class="line"># Allow bold colors - necessary for some reason</span><br><span class="line">attrcolor b &quot;.I&quot;</span><br><span class="line"></span><br><span class="line"># Tell screen how to set colors. AB &#x3D; background, AF&#x3D;foreground</span><br><span class="line">termcapinfo xterm &#39;Co#256:AB&#x3D;\E[48;5;%dm:AF&#x3D;\E[38;5;%dm&#39;</span><br><span class="line"># Enables use of shift-PgUp and shift-PgDn</span><br><span class="line"># termcapinfo xterm|xterms|xs|rxvt ti@:te@</span><br><span class="line">termcapinfo xterm* ti@:te@</span><br><span class="line"># Erase background with current bg color</span><br><span class="line">defbce &quot;on&quot;</span><br><span class="line"></span><br><span class="line"># Enable 256 color term</span><br><span class="line">term xterm-256color</span><br><span class="line"></span><br><span class="line"># Cache 30000 lines for scroll back</span><br><span class="line">defscrollback 30000</span><br><span class="line"></span><br><span class="line"># change command character from ctrl-a to ctrl-b (emacs users may want this)</span><br><span class="line">#escape ^Bb</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### pass commands to screen for describing windows</span><br><span class="line">shelltitle &#39;$ |zsh&#39;</span><br><span class="line"></span><br><span class="line">### set caption</span><br><span class="line">caption always &#39;%&#123;&#x3D; kw&#125;[ %&#123;y&#125;%H%&#123;-&#125; ][ %&#x3D; %-Lw%&#123;+b M&#125;%n%f* %t%&#123;-&#125;%+LW %&#x3D; ][ %&#123;r&#125;%l%&#123;-&#125; ][ %&#123;c&#125;%c%&#123;-&#125; ]&#39;</span><br></pre></td></tr></table></figure>
	

	</div>
  <a type="button" href="/2021/02/09/GNU-SCREEN配置以及动态设置标题/#more" class="btn btn-default more">Read More</a>
</div>

-->
<div class="entry">
  <div class="row">
	
	
		<p>最近开始使用GNU的screen来管理terminal的窗口，但是当开窗口多的时候，会面临不知道每个窗口是做什么的，默认的窗口标题也非常不友好，官网文档也没太多描述，最后好不容易找到了设置方法，记录一下配置。</p>
<p>.zshrc文件里添加如下配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># dynamic titles for screen</span><br><span class="line">preexec () &#123;</span><br><span class="line">  echo -ne &quot;\ek$&#123;(s: :)1&#125;\e\\&quot;</span><br></pre></td></tr></table></figure>

<p>.screenrc文件里添加如下配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">startup_message off</span><br><span class="line"></span><br><span class="line"># GNU Screen - main configuration file</span><br><span class="line"># All other .screenrc files will source this file to inherit settings.</span><br><span class="line"># Author: Christian Wills - cwills.sys@gmail.com</span><br><span class="line"></span><br><span class="line"># Allow bold colors - necessary for some reason</span><br><span class="line">attrcolor b &quot;.I&quot;</span><br><span class="line"></span><br><span class="line"># Tell screen how to set colors. AB &#x3D; background, AF&#x3D;foreground</span><br><span class="line">termcapinfo xterm &#39;Co#256:AB&#x3D;\E[48;5;%dm:AF&#x3D;\E[38;5;%dm&#39;</span><br><span class="line"># Enables use of shift-PgUp and shift-PgDn</span><br><span class="line"># termcapinfo xterm|xterms|xs|rxvt ti@:te@</span><br><span class="line">termcapinfo xterm* ti@:te@</span><br><span class="line"># Erase background with current bg color</span><br><span class="line">defbce &quot;on&quot;</span><br><span class="line"></span><br><span class="line"># Enable 256 color term</span><br><span class="line">term xterm-256color</span><br><span class="line"></span><br><span class="line"># Cache 30000 lines for scroll back</span><br><span class="line">defscrollback 30000</span><br><span class="line"></span><br><span class="line"># change command character from ctrl-a to ctrl-b (emacs users may want this)</span><br><span class="line">#escape ^Bb</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### pass commands to screen for describing windows</span><br><span class="line">shelltitle &#39;$ |zsh&#39;</span><br><span class="line"></span><br><span class="line">### set caption</span><br><span class="line">caption always &#39;%&#123;&#x3D; kw&#125;[ %&#123;y&#125;%H%&#123;-&#125; ][ %&#x3D; %-Lw%&#123;+b M&#125;%n%f* %t%&#123;-&#125;%+LW %&#x3D; ][ %&#123;r&#125;%l%&#123;-&#125; ][ %&#123;c&#125;%c%&#123;-&#125; ]&#39;</span><br></pre></td></tr></table></figure>
	
	</div>
  <a type="button" href="/2021/02/09/GNU-SCREEN配置以及动态设置标题/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2021/02/03/TCP超时问题调试/" >TCP超时问题调试</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2021-02-03  </div>
		</div>
	</div>
	


			<!--
<div class="entry">
  <div class="row">
	
	
		<p>最近有一个项目，使用的Node的Request类库来进行HTTP请求获取数据，每个HTTP请求都要用到短效代理。为了提高可用性，加入了重试机制，如果代理失效，则更换代理重试。为了防止代理速度过慢，设置了timeout参数，该参数在文档中的说明是：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">timeout - integer containing number of milliseconds, controls two timeouts.</span><br><span class="line">Read timeout: Time to wait for a server to send response headers (and start the response body) before aborting the request.</span><br><span class="line">Connection timeout: Sets the socket to timeout after timeout milliseconds of inactivity. Note that increasing the timeout beyond the OS-wide TCP connection timeout will not have any effect (the default in Linux can be anywhere from 20-120 seconds)</span><br></pre></td></tr></table></figure>
<p>该参数为设置了4秒。但是有些请求竟然1分15秒才返回。</p>
<p>curl对代理进行测试结果如下，由此可见timeout参数并没有生效。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">time curl  -vvv -x http:&#x2F;&#x2F;106.5.193.161:4245 baidu.com</span><br><span class="line">*   Trying 106.5.193.161...</span><br><span class="line">* TCP_NODELAY set</span><br><span class="line">* Connection failed</span><br><span class="line">* connect to 106.5.193.161 port 4245 failed: Operation timed out</span><br><span class="line">* Failed to connect to 106.5.193.161 port 4245: Operation timed out</span><br><span class="line">* Closing connection 0</span><br><span class="line">curl: (7) Failed to connect to 106.5.193.161 port 4245: Operation timed out</span><br><span class="line">curl -vvv -x http:&#x2F;&#x2F;106.5.193.161:4245 baidu.com  0.00s user 0.01s system 0% cpu 1:15.76 total</span><br></pre></td></tr></table></figure>
<p>于是猜测应该是tcp重试机制导致的，于是打开<code>Wireshark</code>观察网络请求，发现系统尝试发送了10次SYN数据包。<br><img src="https://cdn.jsdelivr.net/gh/xiaodang/blog-image/img/20210203092249.png"></p>
<p>定位到原因之后，有两个解决办法，第一个是在应用层强制超时，第一个是修改系统tcp的重试参数。</p>
<p>为了尽快解决问题，选择第二种方案，由于线上是CentOS，只需要执行即可临时修改syn数据包的重试次数为1。修改后再次通过curl测试，发现可以很快返回超时。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sysctl -w net.ipv4.tcp_syn_retries&#x3D;1</span><br></pre></td></tr></table></figure>

	

	</div>
  <a type="button" href="/2021/02/03/TCP超时问题调试/#more" class="btn btn-default more">Read More</a>
</div>

-->
<div class="entry">
  <div class="row">
	
	
		<p>最近有一个项目，使用的Node的Request类库来进行HTTP请求获取数据，每个HTTP请求都要用到短效代理。为了提高可用性，加入了重试机制，如果代理失效，则更换代理重试。为了防止代理速度过慢，设置了timeout参数，该参数在文档中的说明是：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">timeout - integer containing number of milliseconds, controls two timeouts.</span><br><span class="line">Read timeout: Time to wait for a server to send response headers (and start the response body) before aborting the request.</span><br><span class="line">Connection timeout: Sets the socket to timeout after timeout milliseconds of inactivity. Note that increasing the timeout beyond the OS-wide TCP connection timeout will not have any effect (the default in Linux can be anywhere from 20-120 seconds)</span><br></pre></td></tr></table></figure>
<p>该参数为设置了4秒。但是有些请求竟然1分15秒才返回。</p>
<p>curl对代理进行测试结果如下，由此可见timeout参数并没有生效。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">time curl  -vvv -x http:&#x2F;&#x2F;106.5.193.161:4245 baidu.com</span><br><span class="line">*   Trying 106.5.193.161...</span><br><span class="line">* TCP_NODELAY set</span><br><span class="line">* Connection failed</span><br><span class="line">* connect to 106.5.193.161 port 4245 failed: Operation timed out</span><br><span class="line">* Failed to connect to 106.5.193.161 port 4245: Operation timed out</span><br><span class="line">* Closing connection 0</span><br><span class="line">curl: (7) Failed to connect to 106.5.193.161 port 4245: Operation timed out</span><br><span class="line">curl -vvv -x http:&#x2F;&#x2F;106.5.193.161:4245 baidu.com  0.00s user 0.01s system 0% cpu 1:15.76 total</span><br></pre></td></tr></table></figure>
<p>于是猜测应该是tcp重试机制导致的，于是打开<code>Wireshark</code>观察网络请求，发现系统尝试发送了10次SYN数据包。<br><img src="https://cdn.jsdelivr.net/gh/xiaodang/blog-image/img/20210203092249.png"></p>
<p>定位到原因之后，有两个解决办法，第一个是在应用层强制超时，第一个是修改系统tcp的重试参数。</p>
<p>为了尽快解决问题，选择第二种方案，由于线上是CentOS，只需要执行即可临时修改syn数据包的重试次数为1。修改后再次通过curl测试，发现可以很快返回超时。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sysctl -w net.ipv4.tcp_syn_retries&#x3D;1</span><br></pre></td></tr></table></figure>

	
	</div>
  <a type="button" href="/2021/02/03/TCP超时问题调试/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2020/12/20/如何调试招商银行App内置的webview/" >如何调试招商银行App内置的webview</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2020-12-20  </div>
		</div>
	</div>
	


			<!--
<div class="entry">
  <div class="row">
	
	
		<p>最近招商银行有一个10元风暴的活动，集喵喵，最高可以兑换5000元礼品卡。但是听同事说，这个兑换需要拼手速。作为工程师，能用程序解决的，坚决不用手解决。（其实是想练习一下遗忘已久的逆向技能</p>
<h3 id="分析思路"><a href="#分析思路" class="headerlink" title="分析思路"></a>分析思路</h3><p>第一次尝试，先用Charles抓包，但是发现设置代理之后打开银行app直接闪退，果然大银行，对HTTPS证书进行了校验。失败。<br>第二次尝试，用rvictl创建iphone的虚拟网络端口，然后用Wireshark监听所有流量，发现确实走的是HTTPS协议，不是tcp。但是由于内容都是加密的，没什么其他收获。<br>第三次，那就只有祭出必杀器。越狱。</p>
<h3 id="可行的方案"><a href="#可行的方案" class="headerlink" title="可行的方案"></a>可行的方案</h3><ul>
<li><p>首先对手机进行越狱，由于备用机是iOS13.7，目前没有完美越狱，但是checkra1n可以进行非完美越狱。checkra1n的官网是checkra.in,有一个冒充的钓鱼网站要小心。根据官网的越狱步骤，遇到了一点小问题，我的手机就是无法进入DFU模式，最后把Tyep C的线换成了USB的线才搞定。:(</p>
</li>
<li><p>由于银行对证书有检测，所以必须要干掉证书的检测。github上有一个项目SSL Kill Switch 2可以做这件事儿。而且很顺利，屏蔽掉证书检测之后，可以成功的捕获到所有的HTTPS数据包，但是分析数据包之后，发现并没有什么作用，因为内容都是加密的。</p>
</li>
<li><p>既然数据包没用，那我们就从UI着手，大不了最后模拟点击或者hook事件重放就可以了。既然是内嵌的Webview，第一个想到的就是通过Safair的开发工具进行调试。但是release的App是无法进行调试，因为大部分都不会开启这个功能。但是既然都越狱了，自然有办法。github上的GlobalWebinspect项目可以帮助我们，安装之后，发现可以进行调试了。</p>
</li>
<li><p>既然可以调试web了，那就欢迎进入web的世界～ 剩下的，就是抽丝剥茧找到相应的事件去触发了。</p>
</li>
</ul>
<p>其实，获取礼品不是目的。如何做到，才能技术该追求的。</p>

	

	</div>
  <a type="button" href="/2020/12/20/如何调试招商银行App内置的webview/#more" class="btn btn-default more">Read More</a>
</div>

-->
<div class="entry">
  <div class="row">
	
	
		<p>最近招商银行有一个10元风暴的活动，集喵喵，最高可以兑换5000元礼品卡。但是听同事说，这个兑换需要拼手速。作为工程师，能用程序解决的，坚决不用手解决。（其实是想练习一下遗忘已久的逆向技能</p>
<h3 id="分析思路"><a href="#分析思路" class="headerlink" title="分析思路"></a>分析思路</h3><p>第一次尝试，先用Charles抓包，但是发现设置代理之后打开银行app直接闪退，果然大银行，对HTTPS证书进行了校验。失败。<br>第二次尝试，用rvictl创建iphone的虚拟网络端口，然后用Wireshark监听所有流量，发现确实走的是HTTPS协议，不是tcp。但是由于内容都是加密的，没什么其他收获。<br>第三次，那就只有祭出必杀器。越狱。</p>
<h3 id="可行的方案"><a href="#可行的方案" class="headerlink" title="可行的方案"></a>可行的方案</h3><ul>
<li><p>首先对手机进行越狱，由于备用机是iOS13.7，目前没有完美越狱，但是checkra1n可以进行非完美越狱。checkra1n的官网是checkra.in,有一个冒充的钓鱼网站要小心。根据官网的越狱步骤，遇到了一点小问题，我的手机就是无法进入DFU模式，最后把Tyep C的线换成了USB的线才搞定。:(</p>
</li>
<li><p>由于银行对证书有检测，所以必须要干掉证书的检测。github上有一个项目SSL Kill Switch 2可以做这件事儿。而且很顺利，屏蔽掉证书检测之后，可以成功的捕获到所有的HTTPS数据包，但是分析数据包之后，发现并没有什么作用，因为内容都是加密的。</p>
</li>
<li><p>既然数据包没用，那我们就从UI着手，大不了最后模拟点击或者hook事件重放就可以了。既然是内嵌的Webview，第一个想到的就是通过Safair的开发工具进行调试。但是release的App是无法进行调试，因为大部分都不会开启这个功能。但是既然都越狱了，自然有办法。github上的GlobalWebinspect项目可以帮助我们，安装之后，发现可以进行调试了。</p>
</li>
<li><p>既然可以调试web了，那就欢迎进入web的世界～ 剩下的，就是抽丝剥茧找到相应的事件去触发了。</p>
</li>
</ul>
<p>其实，获取礼品不是目的。如何做到，才能技术该追求的。</p>

	
	</div>
  <a type="button" href="/2020/12/20/如何调试招商银行App内置的webview/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2020/12/18/利用MutationObserver-API追踪DOM的修改/" >利用MutationObserver API追踪DOM的修改</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2020-12-18  </div>
		</div>
	</div>
	


			<!--
<div class="entry">
  <div class="row">
	
	
		<p>之前写爬虫的时候，经常需要从界面入手，找到自己想要的数据，然后看网络请求，来搜索是哪个api返回的数据，一般情况下，都能从网络请求中发现想要的数据。但是当数据做了混淆之后，很多数据是没有办法直接从api中搜索到的。这时候就可以用到<code>MutationObserver</code> API。</p>
<p>MDN上的描述<code>The MutationObserver interface provides the ability to watch for changes being made to the DOM tree. </code>。简单翻译一下就是，这个接口提供了监控DOM树变化的能力。</p>
<h3 id="MDN的例子"><a href="#MDN的例子" class="headerlink" title="MDN的例子"></a>MDN的例子</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; Select the node that will be observed for mutations</span><br><span class="line">const targetNode &#x3D; document.getElementById(&#39;some-id&#39;);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; Options for the observer (which mutations to observe)</span><br><span class="line">const config &#x3D; &#123; attributes: true, childList: true, subtree: true &#125;;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; Callback function to execute when mutations are observed</span><br><span class="line">const callback &#x3D; function(mutationsList, observer) &#123;</span><br><span class="line">    &#x2F;&#x2F; Use traditional &#39;for loops&#39; for IE 11</span><br><span class="line">    &#x2F;&#x2F;如果需要调试的话，只需要在callback里面执行debugger就可以了</span><br><span class="line">    for(const mutation of mutationsList) &#123;</span><br><span class="line">        if (mutation.type &#x3D;&#x3D;&#x3D; &#39;childList&#39;) &#123;</span><br><span class="line">            console.log(&#39;A child node has been added or removed.&#39;);</span><br><span class="line">        &#125;</span><br><span class="line">        else if (mutation.type &#x3D;&#x3D;&#x3D; &#39;attributes&#39;) &#123;</span><br><span class="line">            console.log(&#39;The &#39; + mutation.attributeName + &#39; attribute was modified.&#39;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; Create an observer instance linked to the callback function</span><br><span class="line">const observer &#x3D; new MutationObserver(callback);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; Start observing the target node for configured mutations</span><br><span class="line">observer.observe(targetNode, config);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; Later, you can stop observing</span><br><span class="line">observer.disconnect();</span><br></pre></td></tr></table></figure>


	

	</div>
  <a type="button" href="/2020/12/18/利用MutationObserver-API追踪DOM的修改/#more" class="btn btn-default more">Read More</a>
</div>

-->
<div class="entry">
  <div class="row">
	
	
		<p>之前写爬虫的时候，经常需要从界面入手，找到自己想要的数据，然后看网络请求，来搜索是哪个api返回的数据，一般情况下，都能从网络请求中发现想要的数据。但是当数据做了混淆之后，很多数据是没有办法直接从api中搜索到的。这时候就可以用到<code>MutationObserver</code> API。</p>
<p>MDN上的描述<code>The MutationObserver interface provides the ability to watch for changes being made to the DOM tree. </code>。简单翻译一下就是，这个接口提供了监控DOM树变化的能力。</p>
<h3 id="MDN的例子"><a href="#MDN的例子" class="headerlink" title="MDN的例子"></a>MDN的例子</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; Select the node that will be observed for mutations</span><br><span class="line">const targetNode &#x3D; document.getElementById(&#39;some-id&#39;);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; Options for the observer (which mutations to observe)</span><br><span class="line">const config &#x3D; &#123; attributes: true, childList: true, subtree: true &#125;;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; Callback function to execute when mutations are observed</span><br><span class="line">const callback &#x3D; function(mutationsList, observer) &#123;</span><br><span class="line">    &#x2F;&#x2F; Use traditional &#39;for loops&#39; for IE 11</span><br><span class="line">    &#x2F;&#x2F;如果需要调试的话，只需要在callback里面执行debugger就可以了</span><br><span class="line">    for(const mutation of mutationsList) &#123;</span><br><span class="line">        if (mutation.type &#x3D;&#x3D;&#x3D; &#39;childList&#39;) &#123;</span><br><span class="line">            console.log(&#39;A child node has been added or removed.&#39;);</span><br><span class="line">        &#125;</span><br><span class="line">        else if (mutation.type &#x3D;&#x3D;&#x3D; &#39;attributes&#39;) &#123;</span><br><span class="line">            console.log(&#39;The &#39; + mutation.attributeName + &#39; attribute was modified.&#39;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; Create an observer instance linked to the callback function</span><br><span class="line">const observer &#x3D; new MutationObserver(callback);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; Start observing the target node for configured mutations</span><br><span class="line">observer.observe(targetNode, config);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; Later, you can stop observing</span><br><span class="line">observer.disconnect();</span><br></pre></td></tr></table></figure>


	
	</div>
  <a type="button" href="/2020/12/18/利用MutationObserver-API追踪DOM的修改/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2020/12/13/rvictl-iOS网络数据分析工具/" >rvictl-iOS网络数据分析工具</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2020-12-13  </div>
		</div>
	</div>
	


			<!--
<div class="entry">
  <div class="row">
	
	
		<p>之前在iPhone上抓包都是用的<code>Charlse</code>,但是只能捕获HTTP和HTTPS对流量。</p>
<p>今天发现了苹果的一个工具叫<code>rvictl</code>，rvi是Remote Virtual Interface的缩写，表示远程虚拟接口。把iPhone通过USB连接电脑之后，通过rvictl就可以创建一个虚拟接口。接下来就可以用tcpdump或者wireshark来监听这个网络接口上的流量。</p>
<p>但是，由于系统升级了Big Sur，目前这个工具在我的电脑上暂时无法使用。只能等下来的版本再测试一下。</p>

	

	</div>
  <a type="button" href="/2020/12/13/rvictl-iOS网络数据分析工具/#more" class="btn btn-default more">Read More</a>
</div>

-->
<div class="entry">
  <div class="row">
	
	
		<p>之前在iPhone上抓包都是用的<code>Charlse</code>,但是只能捕获HTTP和HTTPS对流量。</p>
<p>今天发现了苹果的一个工具叫<code>rvictl</code>，rvi是Remote Virtual Interface的缩写，表示远程虚拟接口。把iPhone通过USB连接电脑之后，通过rvictl就可以创建一个虚拟接口。接下来就可以用tcpdump或者wireshark来监听这个网络接口上的流量。</p>
<p>但是，由于系统升级了Big Sur，目前这个工具在我的电脑上暂时无法使用。只能等下来的版本再测试一下。</p>

	
	</div>
  <a type="button" href="/2020/12/13/rvictl-iOS网络数据分析工具/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2020/12/03/monkeyDev开发/" >monkeyDev开发</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2020-12-03  </div>
		</div>
	</div>
	


			<!--
<div class="entry">
  <div class="row">
	
	
		<p>今天进行iOS逆向开发，肯定会遇到很多坑，之前的坑都踩过，但是没有记录，这次记录一下。</p>
<h3 id="坑1-签名失败"><a href="#坑1-签名失败" class="headerlink" title="坑1 签名失败"></a>坑1 签名失败</h3><p>安装完后mokeyDev之后，在XCode创建一个新项目，但是对于一直报错无法签名，最后查资料可以在target的Build Settings里面增加一个自定义配置，<code>CODE_SIGNING_ALLOWED=NO</code>，最后编译成功。</p>
<h3 id="坑2-无法找到libstdc-类库"><a href="#坑2-无法找到libstdc-类库" class="headerlink" title="坑2 无法找到libstdc++类库"></a>坑2 无法找到libstdc++类库</h3><p>这个比较常见，是因为xcode移除了libstdcc，如果类库依赖的话，只需要找到放在对应目录下就可以。</p>
<h3 id="如何查看ipa是否加密"><a href="#如何查看ipa是否加密" class="headerlink" title="如何查看ipa是否加密"></a>如何查看ipa是否加密</h3><p>otool -l Target | grep -A 4 LC_ENCRYPTION_INFO</p>
<h3 id="cycrpt-打印当前界面的UI结构"><a href="#cycrpt-打印当前界面的UI结构" class="headerlink" title="cycrpt 打印当前界面的UI结构"></a>cycrpt 打印当前界面的UI结构</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cy# UIApp.keyWindow.recursiveDescription().toString()</span><br><span class="line">c# [[UIApp keyWindow] _autolayoutTrace].toString()</span><br></pre></td></tr></table></figure>
<h3 id="find-controller"><a href="#find-controller" class="headerlink" title="find controller"></a>find controller</h3>
	

	</div>
  <a type="button" href="/2020/12/03/monkeyDev开发/#more" class="btn btn-default more">Read More</a>
</div>

-->
<div class="entry">
  <div class="row">
	
	
		<p>今天进行iOS逆向开发，肯定会遇到很多坑，之前的坑都踩过，但是没有记录，这次记录一下。</p>
<h3 id="坑1-签名失败"><a href="#坑1-签名失败" class="headerlink" title="坑1 签名失败"></a>坑1 签名失败</h3><p>安装完后mokeyDev之后，在XCode创建一个新项目，但是对于一直报错无法签名，最后查资料可以在target的Build Settings里面增加一个自定义配置，<code>CODE_SIGNING_ALLOWED=NO</code>，最后编译成功。</p>
<h3 id="坑2-无法找到libstdc-类库"><a href="#坑2-无法找到libstdc-类库" class="headerlink" title="坑2 无法找到libstdc++类库"></a>坑2 无法找到libstdc++类库</h3><p>这个比较常见，是因为xcode移除了libstdcc，如果类库依赖的话，只需要找到放在对应目录下就可以。</p>
<h3 id="如何查看ipa是否加密"><a href="#如何查看ipa是否加密" class="headerlink" title="如何查看ipa是否加密"></a>如何查看ipa是否加密</h3><p>otool -l Target | grep -A 4 LC_ENCRYPTION_INFO</p>
<h3 id="cycrpt-打印当前界面的UI结构"><a href="#cycrpt-打印当前界面的UI结构" class="headerlink" title="cycrpt 打印当前界面的UI结构"></a>cycrpt 打印当前界面的UI结构</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cy# UIApp.keyWindow.recursiveDescription().toString()</span><br><span class="line">c# [[UIApp keyWindow] _autolayoutTrace].toString()</span><br></pre></td></tr></table></figure>
<h3 id="find-controller"><a href="#find-controller" class="headerlink" title="find controller"></a>find controller</h3>
	
	</div>
  <a type="button" href="/2020/12/03/monkeyDev开发/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2020/11/16/macOS如何打开新窗口执行脚本/" >macOS如何打开新窗口执行脚本</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2020-11-16  </div>
		</div>
	</div>
	


			<!--
<div class="entry">
  <div class="row">
	
	
		<p>今天需要写一个脚本同时ssh连接到不同到服务器执行任务，并实时观察log，所以需要写一个脚本打开新的terminal，查找后发现可以用macOS的osascript命令，记录一下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">osascript -e <span class="string">&#x27;tell application &quot;Terminal&quot; to do script &quot;ls&quot;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>由于连接每次连接ssh都需要输入yes来信任host，可以在<code>～/.ssh/config</code>文件中添加<code>StrictHostKeyChecking no</code>来取消检查，这也可以方便脚本的执行，但是用完记得取消，否则这样做是不安全的。</p>

	

	</div>
  <a type="button" href="/2020/11/16/macOS如何打开新窗口执行脚本/#more" class="btn btn-default more">Read More</a>
</div>

-->
<div class="entry">
  <div class="row">
	
	
		<p>今天需要写一个脚本同时ssh连接到不同到服务器执行任务，并实时观察log，所以需要写一个脚本打开新的terminal，查找后发现可以用macOS的osascript命令，记录一下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">osascript -e <span class="string">&#x27;tell application &quot;Terminal&quot; to do script &quot;ls&quot;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>由于连接每次连接ssh都需要输入yes来信任host，可以在<code>～/.ssh/config</code>文件中添加<code>StrictHostKeyChecking no</code>来取消检查，这也可以方便脚本的执行，但是用完记得取消，否则这样做是不安全的。</p>

	
	</div>
  <a type="button" href="/2020/11/16/macOS如何打开新窗口执行脚本/#more" class="btn btn-default more">Read More</a>
</div>

		
			
	
	<!-- display as entry -->
<div class="row">
	<div class="col-md-8">
		<h3 class="title">
			<a href="/2020/11/12/libuv初探/" >libuv初探</a>
		</h3>
		</div>
	<div class="col-md-4">
		<div class="date">post @ 2020-11-12  </div>
		</div>
	</div>
	


			<!--
<div class="entry">
  <div class="row">
	
	
		<p>今天研究了一下Node使用的异步IO框架libuv,下面一张图显示了livuv在Node架构中的位置。</p>
<p><img src="https://cdn.jsdelivr.net/gh/xiaodang/blog-image/img/20201112091257.png"></p>
<h2 id="libuv是什么"><a href="#libuv是什么" class="headerlink" title="libuv是什么"></a>libuv是什么</h2><p>libuv是一个高性能的，事件驱动的I/O库，并且提供了跨平台（如windows, linux）的API。</p>
<h2 id="libuv架构"><a href="#libuv架构" class="headerlink" title="libuv架构"></a>libuv架构</h2><p><img src="https://cdn.jsdelivr.net/gh/xiaodang/blog-image/img/20201112091634.png"></p>
<p>左侧部分是网络I/O相关的请求，右侧部分是由文件I/O, DNS Ops以及User code组成的请求。对于Network I/O和以File I/O为代表的另一类请求，异步处理的机制是不一样的。</p>
<p>对于Network I/O相关的请求， 根据OS平台不同，分别使用Linux上的epoll，OSX和BSD类OS上的kqueue，SunOS上的event ports以及Windows上的IOCP机制。</p>
<p>而对于File I/O为代表的请求，则使用thread pool。利用thread pool的方式实现异步请求处理，在各类OS上都能获得很好的支持。</p>
<h2 id="I-O-loop"><a href="#I-O-loop" class="headerlink" title="I/O loop"></a>I/O loop</h2>
	

	</div>
  <a type="button" href="/2020/11/12/libuv初探/#more" class="btn btn-default more">Read More</a>
</div>

-->
<div class="entry">
  <div class="row">
	
	
		<p>今天研究了一下Node使用的异步IO框架libuv,下面一张图显示了livuv在Node架构中的位置。</p>
<p><img src="https://cdn.jsdelivr.net/gh/xiaodang/blog-image/img/20201112091257.png"></p>
<h2 id="libuv是什么"><a href="#libuv是什么" class="headerlink" title="libuv是什么"></a>libuv是什么</h2><p>libuv是一个高性能的，事件驱动的I/O库，并且提供了跨平台（如windows, linux）的API。</p>
<h2 id="libuv架构"><a href="#libuv架构" class="headerlink" title="libuv架构"></a>libuv架构</h2><p><img src="https://cdn.jsdelivr.net/gh/xiaodang/blog-image/img/20201112091634.png"></p>
<p>左侧部分是网络I/O相关的请求，右侧部分是由文件I/O, DNS Ops以及User code组成的请求。对于Network I/O和以File I/O为代表的另一类请求，异步处理的机制是不一样的。</p>
<p>对于Network I/O相关的请求， 根据OS平台不同，分别使用Linux上的epoll，OSX和BSD类OS上的kqueue，SunOS上的event ports以及Windows上的IOCP机制。</p>
<p>而对于File I/O为代表的请求，则使用thread pool。利用thread pool的方式实现异步请求处理，在各类OS上都能获得很好的支持。</p>
<h2 id="I-O-loop"><a href="#I-O-loop" class="headerlink" title="I/O loop"></a>I/O loop</h2>
	
	</div>
  <a type="button" href="/2020/11/12/libuv初探/#more" class="btn btn-default more">Read More</a>
</div>

		

		</div>

		<!-- pagination -->
		<div>
  		<center>
		<div class="pagination">

   
    
           <a type="button" class="btn btn-default disabled"><i class="fa fa-arrow-circle-o-left"></i>Prev</a>
        

        <a href="/" type="button" class="btn btn-default"><i class="fa fa-home"></i>Home</a>
 
       <a href="/page/2/" type="button" class="btn btn-default ">Next<i class="fa fa-arrow-circle-o-right"></i></a>     
        

  
</div>

  		</center>
		</div>

		
		
	</div> <!-- col-md-9 -->

	
		<div class="col-md-3">
	<div id="sidebar">
	
			
  <div id="site_search">
   <div class="form-group">
    <input type="text" id="local-search-input" name="q" results="0" placeholder="Search" class="st-search-input st-default-search-input form-control"/>
   </div>  
  <div id="local-search-result"></div>
  </div>


		
			
	<div class="widget">
		<h4>Categories</h4>
		<ul class="tag_box inline list-unstyled">
		
			<li><a href="/categories/开发工具/">开发工具<span>2</span></a></li>
		
			<li><a href="/categories/算法/">算法<span>2</span></a></li>
		
			<li><a href="/categories/编程/">编程<span>8</span></a></li>
		
		</ul>
	</div>

		
			
	<div class="widget">
		<h4>Tag Cloud</h4>
		<ul class="tag_box inline list-unstyled">		
		
			<li><a href="/tags/libuv/">libuv<span>1</span></a></li>
		
			<li><a href="/tags/编译器/">编译器<span>1</span></a></li>
		
			<li><a href="/tags/算法/">算法<span>2</span></a></li>
		
			<li><a href="/tags/Web/">Web<span>1</span></a></li>
		
			<li><a href="/tags/密码学/">密码学<span>1</span></a></li>
		
			<li><a href="/tags/逆向/">逆向<span>1</span></a></li>
		
			<li><a href="/tags/redis/">redis<span>1</span></a></li>
		
			<li><a href="/tags/JavaScript/">JavaScript<span>1</span></a></li>
		
			<li><a href="/tags/macOS/">macOS<span>3</span></a></li>
		
		 
		</ul>
	</div>


		
			
<div class="widget">
  <h4>Recent Posts</h4>
  <ul class="entry list-unstyled">
    
      <li>
        <a href="/2021/03/05/什么是霍夫曼编码-Huffman-Coding/" ><i class="fa fa-file-o"></i>什么是霍夫曼编码(Huffman Coding)</a>
      </li>
    
      <li>
        <a href="/2021/02/28/SSL-routines-tls-process-ske-dhe-dh-key-too-small/" ><i class="fa fa-file-o"></i>SSL routines:tls_process_sk...</a>
      </li>
    
      <li>
        <a href="/2021/02/09/GNU-SCREEN配置以及动态设置标题/" ><i class="fa fa-file-o"></i>GNU SCREEN配置以及动态设置标题</a>
      </li>
    
      <li>
        <a href="/2021/02/03/TCP超时问题调试/" ><i class="fa fa-file-o"></i>TCP超时问题调试</a>
      </li>
    
      <li>
        <a href="/2020/12/20/如何调试招商银行App内置的webview/" ><i class="fa fa-file-o"></i>如何调试招商银行App内置的webview</a>
      </li>
    
  </ul>
</div>

		
			
<div class="widget">
	<h4>Links</h4>
	<ul class="blogroll list-unstyled">
	
		<li><i class="fa fa-github"></i><a href="https://github.com/xiaodang" title="" target="_blank"]);">github</a></li>
	
	</ul>
</div>


		
	</div> <!-- sidebar -->
</div> <!-- col-md-3 -->

	
	
</div> <!-- row-fluid -->
	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  
  &copy; 2021 xiaodang's Blog
  
      powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. 
      <!-- Theme <a href="https://github.com/Ares-X/hexo-theme-freemind.bithack" target="_blank">freemind.bithack</a>   -->
</p>
 </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>⬆︎TOP</span>
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>

</body>
   </html>
